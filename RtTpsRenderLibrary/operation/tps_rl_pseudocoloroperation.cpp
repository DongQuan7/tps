////////////////////////////////////////////////////////////////
///  Copyright (c) Shanghai United Imaging Healthcare Inc., 2014
///  All rights reserved.
/// 
///  \author  LI Song  song.li@united-imaging.com
/// 
///  \file tps_rl_pseudocoloroperation.cpp
/// 
///  \brief class PseudoColorOperation implementation 
/// 
///  \version 1.0
/// 
///  \date    2014/05/29
////////////////////////////////////////////////////////////////

#include "StdAfx.h"
#include "RtTpsRenderLibrary/tps_rl_pseudocoloroperation.h"
#include "RtTpsRenderLibrary/tps_rl_graphicobjecttypedefines.h"
#include "RtTpsRenderLibrary/tps_rl_fusiongraphicobject.h"
#include "RtTpsRenderLibrary/tps_rl_mprgraphicobject.h"
#include "RtTpsRenderLibrary/tps_rl_drrpseudocolorgraphicobject.h"
#include "RtTpsFramework/tps_fw_modelwarehouse.h"


TPS_BEGIN_NAMESPACE   // begin namespace tps

unsigned char Bones[768] =
{
    0,  0,  0,  
    0,  1,  1,  
    0,  2,  3,  
    0,  3,  5,  
    1,  4,  7,  
    1,  6,  8,  
    1,  7,  10,  
    2,  8,  12,  
    2,  9,  14,  
    2,  11,  15,  
    2,  12,  17,  
    3,  13,  19,  
    3,  14,  21,  
    3,  16,  22,  
    4,  17,  24,  
    4,  18,  26,  
    4,  19,  28,  
    4,  20,  29,  
    5,  22,  31,  
    5,  23,  33,  
    5,  24,  35,  
    6,  25,  37,  
    6,  27,  38,  
    6,  28,  40,  
    6,  29,  42,  
    7,  30,  44,  
    7,  32,  45,  
    7,  33,  47,  
    8,  34,  49,  
    8,  35,  51,  
    8,  37,  52,  
    9,  38,  54,  
    9,  39,  56,  
    9,  40,  58,  
    9,  41,  59,  
    10,  43,  61,  
    10,  44,  63,  
    10,  45,  65,  
    11,  46,  67,  
    11,  48,  68,  
    11,  49,  70,  
    11,  50,  72,  
    12,  51,  74,  
    12,  53,  75,  
    12,  54,  77,  
    13,  55,  79,  
    13,  56,  81,  
    13,  57,  82,  
    13,  59,  84,  
    14,  60,  86,  
    14,  61,  88,  
    14,  62,  89,  
    15,  64,  91,  
    15,  65,  93,  
    15,  66,  95,  
    16,  67,  96,  
    16,  69,  98,  
    16,  70,  100,  
    16,  71,  102,  
    17,  72,  104,  
    17,  74,  105,  
    17,  75,  107,  
    18,  76,  109,  
    18,  77,  111,  
    18,  78,  112,  
    18,  80,  114,  
    19,  81,  116,  
    19,  82,  118,  
    19,  83,  119,  
    20,  85,  121,  
    20,  86,  123,  
    20,  87,  125,  
    20,  88,  126,  
    21,  90,  128,  
    21,  91,  130,  
    21,  92,  132,  
    22,  93,  134,  
    22,  94,  135,  
    22,  96,  137,  
    23,  97,  139,  
    23,  98,  141,  
    23,  99,  142,  
    23,  101,  144,  
    24,  102,  146,  
    24,  103,  148,  
    24,  104,  149,  
    25,  106,  151,  
    25,  107,  153,  
    25,  108,  155,  
    25,  109,  156,  
    26,  111,  158,  
    26,  112,  160,  
    26,  113,  162,  
    27,  114,  164,  
    27,  115,  165,  
    27,  117,  167,  
    27,  118,  169,  
    28,  119,  171,  
    28,  120,  172,  
    28,  122,  174,  
    29,  123,  176,  
    29,  124,  178,  
    29,  125,  179,  
    29,  127,  181,  
    30,  128,  183,  
    30,  129,  185,  
    30,  130,  186,  
    31,  131,  188,  
    31,  133,  190,  
    31,  134,  192,  
    32,  135,  193,  
    32,  136,  195,  
    32,  138,  197,  
    32,  139,  199,  
    33,  140,  201,  
    33,  141,  202,  
    33,  143,  204,  
    34,  144,  206,  
    34,  145,  208,  
    34,  146,  209,  
    34,  148,  211,  
    35,  149,  213,  
    35,  150,  215,  
    35,  151,  216,  
    36,  152,  217,  
    36,  153,  217,  
    36,  153,  218,  
    36,  154,  218,  
    36,  154,  219,  
    37,  155,  219,  
    37,  156,  220,  
    37,  156,  220,  
    37,  157,  221,  
    37,  158,  221,  
    38,  158,  222,  
    38,  159,  222,  
    38,  160,  223,  
    38,  160,  223,  
    39,  161,  224,  
    39,  162,  224,  
    39,  162,  225,  
    39,  163,  225,  
    39,  164,  226,  
    40,  164,  226,  
    40,  165,  227,  
    40,  166,  227,  
    40,  166,  228,  
    40,  167,  228,  
    41,  168,  229,  
    41,  168,  229,  
    41,  169,  230,  
    41,  170,  230,  
    42,  170,  231,  
    42,  171,  231,  
    42,  172,  232,  
    42,  172,  232,  
    42,  173,  233,  
    43,  174,  233,  
    43,  174,  234,  
    43,  175,  234,  
    43,  175,  235,  
    44,  176,  235,  
    44,  177,  236,  
    44,  177,  236,  
    44,  178,  237,  
    44,  179,  237,  
    45,  179,  238,  
    45,  180,  238,  
    45,  181,  239,  
    45,  181,  239,  
    45,  182,  240,  
    46,  183,  240,  
    46,  183,  241,  
    46,  184,  241,  
    46,  185,  242,  
    47,  185,  242,  
    47,  186,  243,  
    47,  187,  243,  
    47,  187,  244,  
    47,  188,  244,  
    48,  189,  245,  
    48,  189,  245,  
    48,  190,  246,  
    48,  191,  246,  
    48,  191,  247,  
    49,  192,  247,  
    49,  193,  248,  
    49,  193,  248,  
    49,  194,  249,  
    50,  195,  249,  
    50,  195,  250,  
    50,  196,  250,  
    50,  196,  251,  
    50,  197,  251,  
    51,  198,  252,  
    51,  198,  252,  
    51,  199,  253,  
    51,  200,  253,  
    51,  200,  254,  
    52,  201,  254,  
    52,  202,  255,  
    52,  203,  255,  
    53,  204,  255,  
    53,  205,  255,  
    53,  206,  255,  
    54,  207,  255,  
    54,  208,  255,  
    54,  209,  255,  
    55,  210,  255,  
    55,  211,  255,  
    55,  213,  255,  
    56,  214,  255,  
    56,  215,  255,  
    56,  216,  255,  
    56,  217,  255,  
    57,  218,  255,  
    57,  219,  255,  
    57,  220,  255,  
    58,  221,  255,  
    58,  222,  255,  
    58,  223,  255,  
    59,  224,  255,  
    59,  226,  255,  
    59,  227,  255,  
    60,  228,  255,  
    60,  229,  255,  
    60,  230,  255,  
    61,  231,  255,  
    61,  232,  255,  
    61,  233,  255,  
    62,  234,  255,  
    62,  235,  255,  
    62,  236,  255,  
    63,  237,  255,  
    63,  239,  255,  
    63,  240,  255,  
    64,  241,  255,  
    64,  242,  255,  
    64,  243,  255,  
    65,  244,  255,  
    65,  245,  255,  
    65,  246,  255,  
    66,  247,  255,  
    66,  248,  255,  
    66,  249,  255,  
    67,  250,  255,  
    84,  251,  255,  
    101,  251,  255,  
    118,  252,  255,  
    135,  252,  255,  
    152,  252,  255,  
    169,  253,  255,  
    186,  253,  255,  
    203,  253,  255,  
    220,  254,  255,  
    237,  254,  255
};

unsigned char Cardiac[768] =
{
    3,  193,  73,  
    12,  195,  72,  
    20,  197,  70,  
    29,  198,  69,  
    37,  200,  68,  
    46,  202,  66,  
    54,  204,  65,  
    63,  206,  63,  
    71,  208,  62,  
    80,  209,  61,  
    88,  211,  59,  
    97,  213,  58,  
    105,  215,  57,  
    114,  217,  55,  
    122,  218,  54,  
    131,  220,  52,  
    139,  222,  51,  
    146,  222,  48,  
    154,  222,  45,  
    161,  222,  41,  
    168,  222,  38,  
    175,  222,  35,  
    183,  222,  32,  
    190,  222,  29,  
    197,  222,  26,  
    204,  222,  22,  
    212,  222,  19,  
    219,  222,  16,  
    226,  222,  13,  
    233,  222,  10,  
    241,  222,  6,  
    248,  222,  3,  
    255,  222,  0,  
    255,  216,  0,  
    255,  211,  0,  
    255,  205,  0,  
    255,  200,  0,  
    255,  194,  0,  
    255,  188,  0,  
    255,  183,  0,  
    255,  177,  0,  
    255,  171,  0,  
    255,  166,  0,  
    255,  160,  0,  
    255,  155,  0,  
    255,  149,  0,  
    255,  143,  0,  
    255,  138,  0,  
    255,  132,  0,  
    255,  128,  0,  
    255,  125,  0,  
    255,  121,  0,  
    255,  118,  0,  
    255,  114,  0,  
    255,  110,  0,  
    255,  107,  0,  
    255,  103,  0,  
    255,  99,  0,  
    255,  96,  0,  
    255,  92,  0,  
    255,  89,  0,  
    255,  85,  0,  
    255,  81,  0,  
    255,  78,  0,  
    255,  74,  0,  
    255,  70,  1,  
    255,  67,  2,  
    255,  63,  3,  
    255,  60,  4,  
    255,  56,  5,  
    255,  52,  6,  
    255,  49,  7,  
    255,  45,  8,  
    255,  41,  9,  
    255,  38,  10,  
    255,  34,  11,  
    255,  31,  12,  
    255,  27,  13,  
    255,  23,  14,  
    255,  20,  15,  
    255,  16,  16,  
    253,  15,  16,  
    252,  14,  17,  
    250,  13,  17,  
    249,  12,  17,  
    247,  11,  17,  
    246,  10,  18,  
    244,  9,  18,  
    243,  8,  18,  
    241,  7,  18,  
    239,  6,  19,  
    238,  5,  19,  
    236,  4,  19,  
    235,  3,  19,  
    233,  2,  20,  
    232,  1,  20,  
    230,  0,  20,  
    229,  0,  21,  
    227,  0,  22,  
    226,  0,  22,  
    224,  0,  23,  
    223,  0,  24,  
    221,  0,  25,  
    220,  0,  25,  
    218,  0,  26,  
    217,  0,  27,  
    215,  0,  28,  
    214,  0,  28,  
    212,  0,  29,  
    211,  0,  30,  
    209,  0,  31,  
    208,  0,  31,  
    206,  0,  32,  
    203,  0,  36,  
    201,  0,  39,  
    198,  0,  43,  
    196,  0,  47,  
    193,  0,  50,  
    191,  0,  54,  
    188,  0,  57,  
    186,  0,  61,  
    183,  0,  65,  
    180,  0,  68,  
    178,  0,  72,  
    175,  0,  76,  
    173,  0,  79,  
    170,  0,  83,  
    168,  0,  86,  
    165,  0,  90,  
    163,  0,  95,  
    161,  0,  99,  
    159,  0,  104,  
    157,  0,  109,  
    155,  0,  113,  
    153,  0,  118,  
    151,  0,  123,  
    149,  0,  128,  
    146,  0,  132,  
    144,  0,  137,  
    142,  0,  142,  
    140,  0,  146,  
    138,  0,  151,  
    136,  0,  156,  
    134,  0,  160,  
    132,  0,  165,  
    127,  0,  169,  
    123,  0,  172,  
    118,  0,  176,  
    113,  0,  179,  
    109,  0,  183,  
    104,  0,  186,  
    99,  0,  190,  
    95,  0,  194,  
    90,  0,  197,  
    85,  0,  201,  
    80,  0,  204,  
    76,  0,  208,  
    71,  0,  211,  
    66,  0,  215,  
    62,  0,  218,  
    57,  0,  222,  
    53,  2,  224,  
    50,  4,  226,  
    46,  6,  228,  
    43,  8,  230,  
    39,  10,  232,  
    36,  12,  234,  
    32,  14,  236,  
    29,  17,  239,  
    25,  19,  241,  
    21,  21,  243,  
    18,  23,  245,  
    14,  25,  247,  
    11,  27,  249,  
    7,  29,  251,  
    4,  31,  253,  
    0,  33,  255,  
    0,  37,  255,  
    0,  41,  255,  
    0,  45,  255,  
    0,  50,  255,  
    0,  54,  255,  
    0,  58,  255,  
    0,  62,  255,  
    0,  66,  255,  
    0,  70,  255,  
    0,  74,  255,  
    0,  78,  255,  
    0,  83,  255,  
    0,  87,  255,  
    0,  91,  255,  
    0,  95,  255,  
    0,  99,  255,  
    0,  103,  255,  
    0,  107,  255,  
    0,  111,  255,  
    0,  116,  255,  
    0,  120,  255,  
    0,  124,  255,  
    0,  128,  255,  
    0,  132,  255,  
    0,  136,  255,  
    0,  140,  255,  
    0,  144,  255,  
    0,  149,  255,  
    0,  153,  255,  
    0,  157,  255,  
    0,  161,  255,  
    0,  165,  255,  
    0,  170,  255,  
    0,  174,  255,  
    0,  179,  255,  
    0,  184,  255,  
    0,  188,  255,  
    0,  193,  255,  
    0,  197,  255,  
    0,  202,  255,  
    0,  207,  255,  
    0,  211,  255,  
    0,  216,  255,  
    0,  221,  255,  
    0,  225,  255,  
    0,  230,  255,  
    0,  234,  255,  
    0,  239,  255,  
    1,  238,  250,  
    2,  237,  245,  
    2,  236,  240,  
    3,  235,  236,  
    4,  234,  231,  
    5,  233,  226,  
    5,  232,  221,  
    6,  231,  216,  
    7,  229,  211,  
    8,  228,  206,  
    8,  227,  201,  
    9,  226,  197,  
    10,  225,  192,  
    11,  224,  187,  
    11,  223,  182,  
    12,  222,  177,  
    11,  220,  171,  
    11,  218,  164,  
    10,  217,  158,  
    10,  215,  151,  
    9,  213,  145,  
    9,  211,  138,  
    8,  209,  132,  
    8,  208,  125,  
    7,  206,  119,  
    6,  204,  112,  
    6,  202,  106,  
    5,  200,  99,  
    5,  198,  93,  
    4,  197,  86,  
    3,  193,  73
};

unsigned char Rainbow1[768] = 
{
    0,  0,  0,  
    4,  0,  2,  
    8,  0,  4,  
    12,  0,  6,  
    16,  0,  8,  
    20,  0,  10,  
    24,  0,  12,  
    28,  0,  14,  
    32,  0,  16,  
    36,  0,  18,  
    40,  0,  20,  
    44,  0,  22,  
    48,  0,  24,  
    52,  0,  26,  
    56,  0,  28,  
    60,  0,  30,  
    64,  0,  32,  
    68,  0,  34,  
    72,  0,  36,  
    76,  0,  38,  
    80,  0,  40,  
    84,  0,  42,  
    88,  0,  44,  
    92,  0,  46,  
    96,  0,  48,  
    100,  0,  50,  
    104,  0,  52,  
    108,  0,  54,  
    112,  0,  56,  
    116,  0,  58,  
    120,  0,  60,  
    124,  0,  62,  
    128,  0,  64,  
    132,  0,  62,  
    136,  0,  60,  
    140,  0,  58,  
    144,  0,  56,  
    148,  0,  54,  
    152,  0,  52,  
    156,  0,  50,  
    160,  0,  48,  
    164,  0,  46,  
    168,  0,  44,  
    172,  0,  42,  
    176,  0,  40,  
    180,  0,  38,  
    184,  0,  36,  
    188,  0,  34,  
    192,  0,  32,  
    196,  0,  30,  
    200,  0,  28,  
    204,  0,  26,  
    208,  0,  24,  
    212,  0,  22,  
    216,  0,  20,  
    220,  0,  18,  
    224,  0,  16,  
    228,  0,  14,  
    232,  0,  12,  
    236,  0,  10,  
    240,  0,  8,  
    244,  0,  6,  
    248,  0,  4,  
    252,  0,  2,  
    255,  0,  0,  
    247,  8,  0,  
    239,  16,  0,  
    231,  24,  0,  
    223,  32,  0,  
    215,  40,  0,  
    207,  48,  0,  
    199,  56,  0,  
    191,  64,  0,  
    183,  72,  0,  
    175,  80,  0,  
    167,  88,  0,  
    159,  96,  0,  
    151,  104,  0,  
    143,  112,  0,  
    135,  120,  0,  
    127,  128,  0,  
    119,  136,  0,  
    111,  144,  0,  
    103,  152,  0,  
    95,  160,  0,  
    87,  168,  0,  
    79,  176,  0,  
    71,  184,  0,  
    63,  192,  0,  
    55,  200,  0,  
    47,  208,  0,  
    39,  216,  0,  
    31,  224,  0,  
    23,  232,  0,  
    15,  240,  0,  
    7,  248,  0,  
    0,  255,  0,  
    0,  255,  4,  
    0,  255,  8,  
    0,  255,  12,  
    0,  255,  16,  
    0,  255,  20,  
    0,  255,  24,  
    0,  255,  28,  
    0,  255,  32,  
    0,  255,  36,  
    0,  255,  40,  
    0,  255,  44,  
    0,  255,  48,  
    0,  255,  52,  
    0,  255,  56,  
    0,  255,  60,  
    0,  255,  64,  
    0,  255,  68,  
    0,  255,  72,  
    0,  255,  76,  
    0,  255,  80,  
    0,  255,  84,  
    0,  255,  88,  
    0,  255,  92,  
    0,  255,  96,  
    0,  255,  100,  
    0,  255,  104,  
    0,  255,  108,  
    0,  255,  112,  
    0,  255,  116,  
    0,  255,  120,  
    0,  255,  124,  
    0,  255,  128,  
    0,  255,  132,  
    0,  255,  136,  
    0,  255,  140,  
    0,  255,  144,  
    0,  255,  148,  
    0,  255,  152,  
    0,  255,  156,  
    0,  255,  160,  
    0,  255,  164,  
    0,  255,  168,  
    0,  255,  172,  
    0,  255,  176,  
    0,  255,  180,  
    0,  255,  184,  
    0,  255,  188,  
    0,  255,  192,  
    0,  255,  196,  
    0,  255,  200,  
    0,  255,  204,  
    0,  255,  208,  
    0,  255,  212,  
    0,  255,  216,  
    0,  255,  220,  
    0,  255,  224,  
    0,  255,  228,  
    0,  255,  232,  
    0,  255,  236,  
    0,  255,  240,  
    0,  255,  244,  
    0,  255,  248,  
    0,  255,  252,  
    0,  255,  255,  
    0,  253,  255,  
    0,  251,  255,  
    0,  249,  255,  
    0,  247,  255,  
    0,  245,  255,  
    0,  243,  255,  
    0,  241,  255,  
    0,  239,  255,  
    0,  237,  255,  
    0,  235,  255,  
    0,  233,  255,  
    0,  231,  255,  
    0,  229,  255,  
    0,  227,  255,  
    0,  225,  255,  
    0,  223,  255,  
    0,  221,  255,  
    0,  219,  255,  
    0,  217,  255,  
    0,  215,  255,  
    0,  213,  255,  
    0,  211,  255,  
    0,  209,  255,  
    0,  207,  255,  
    0,  205,  255,  
    0,  203,  255,  
    0,  201,  255,  
    0,  199,  255,  
    0,  197,  255,  
    0,  195,  255,  
    0,  193,  255,  
    0,  192,  255,  
    0,  189,  255,  
    0,  186,  255,  
    0,  183,  255,  
    0,  180,  255,  
    0,  177,  255,  
    0,  174,  255,  
    0,  171,  255,  
    0,  168,  255,  
    0,  165,  255,  
    0,  162,  255,  
    0,  159,  255,  
    0,  156,  255,  
    0,  153,  255,  
    0,  150,  255,  
    0,  147,  255,  
    0,  144,  255,  
    0,  141,  255,  
    0,  138,  255,  
    0,  135,  255,  
    0,  132,  255,  
    0,  129,  255,  
    0,  126,  255,  
    0,  123,  255,  
    0,  120,  255,  
    0,  117,  255,  
    0,  114,  255,  
    0,  111,  255,  
    0,  108,  255,  
    0,  105,  255,  
    0,  102,  255,  
    0,  99,  255,  
    0,  96,  255,  
    0,  93,  255,  
    0,  90,  255,  
    0,  87,  255,  
    0,  84,  255,  
    0,  81,  255,  
    0,  78,  255,  
    0,  75,  255,  
    0,  72,  255,  
    0,  69,  255,  
    0,  66,  255,  
    0,  63,  255,  
    0,  60,  255,  
    0,  57,  255,  
    0,  54,  255,  
    0,  51,  255,  
    0,  48,  255,  
    0,  45,  255,  
    0,  42,  255,  
    0,  39,  255,  
    0,  36,  255,  
    0,  33,  255,  
    0,  30,  255,  
    0,  27,  255,  
    0,  24,  255,  
    0,  21,  255,  
    0,  18,  255,  
    0,  15,  255,  
    0,  12,  255,  
    0,  9,  255,  
    0,  6,  255,  
    0,  3,  255
};

unsigned char Rainbow2[768] = 
{
    0,  0,  0,  
    3,  0,  4,  
    7,  0,  9,  
    10,  0,  13,  
    14,  0,  18,  
    19,  0,  22,  
    23,  0,  27,  
    28,  0,  31,  
    32,  0,  36,  
    38,  0,  40,  
    43,  0,  45,  
    48,  0,  50,  
    53,  0,  54,  
    59,  0,  58,  
    63,  0,  61,  
    68,  0,  64,  
    72,  0,  68,  
    77,  0,  69,  
    81,  0,  72,  
    86,  0,  74,  
    91,  0,  77,  
    95,  0,  79,  
    100,  0,  80,  
    104,  0,  82,  
    109,  0,  83,  
    113,  0,  85,  
    118,  0,  84,  
    122,  0,  86,  
    127,  0,  87,  
    132,  0,  88,  
    136,  0,  86,  
    141,  0,  87,  
    145,  0,  87,  
    150,  0,  87,  
    154,  0,  85,  
    159,  0,  84,  
    163,  0,  84,  
    168,  0,  84,  
    173,  0,  83,  
    177,  0,  79,  
    182,  0,  78,  
    186,  0,  77,  
    191,  0,  76,  
    195,  0,  71,  
    200,  0,  70,  
    204,  0,  68,  
    209,  0,  66,  
    214,  0,  60,  
    218,  0,  58,  
    223,  0,  55,  
    227,  0,  53,  
    232,  0,  46,  
    236,  0,  43,  
    241,  0,  40,  
    245,  0,  36,  
    250,  0,  33,  
    255,  0,  25,  
    255,  0,  21,  
    255,  0,  16,  
    255,  0,  12,  
    255,  0,  4,  
    255,  0,  0,  
    255,  4,  0,  
    255,  8,  0,  
    255,  16,  0,  
    255,  21,  0,  
    255,  25,  0,  
    255,  29,  0,  
    255,  38,  0,  
    255,  42,  0,  
    255,  46,  0,  
    255,  51,  0,  
    255,  55,  0,  
    255,  63,  0,  
    255,  67,  0,  
    255,  72,  0,  
    255,  76,  0,  
    255,  84,  0,  
    255,  89,  0,  
    255,  93,  0,  
    255,  97,  0,  
    255,  106,  0,  
    255,  110,  0,  
    255,  114,  0,  
    255,  119,  0,  
    255,  127,  0,  
    255,  131,  0,  
    255,  135,  0,  
    255,  140,  0,  
    255,  144,  0,  
    255,  152,  0,  
    255,  157,  0,  
    255,  161,  0,  
    255,  165,  0,  
    255,  174,  0,  
    255,  178,  0,  
    255,  182,  0,  
    255,  187,  0,  
    255,  195,  0,  
    255,  199,  0,  
    255,  203,  0,  
    255,  208,  0,  
    255,  216,  0,  
    255,  220,  0,  
    255,  225,  0,  
    255,  229,  0,  
    255,  233,  0,  
    255,  242,  0,  
    255,  246,  0,  
    255,  250,  0,  
    255,  255,  0,  
    246,  255,  0,  
    242,  255,  0,  
    238,  255,  0,  
    233,  255,  0,  
    225,  255,  0,  
    220,  255,  0,  
    216,  255,  0,  
    212,  255,  0,  
    203,  255,  0,  
    199,  255,  0,  
    195,  255,  0,  
    191,  255,  0,  
    187,  255,  0,  
    178,  255,  0,  
    174,  255,  0,  
    170,  255,  0,  
    165,  255,  0,  
    157,  255,  0,  
    152,  255,  0,  
    148,  255,  0,  
    144,  255,  0,  
    135,  255,  0,  
    131,  255,  0,  
    127,  255,  0,  
    123,  255,  0,  
    114,  255,  0,  
    110,  255,  0,  
    106,  255,  0,  
    102,  255,  0,  
    97,  255,  0,  
    89,  255,  0,  
    84,  255,  0,  
    80,  255,  0,  
    76,  255,  0,  
    67,  255,  0,  
    63,  255,  0,  
    59,  255,  0,  
    55,  255,  0,  
    46,  255,  0,  
    42,  255,  0,  
    38,  255,  0,  
    34,  255,  0,  
    25,  255,  0,  
    21,  255,  0,  
    16,  255,  0,  
    12,  255,  0,  
    8,  255,  0,  
    0,  255,  0,  
    0,  255,  4,  
    0,  255,  8,  
    0,  255,  12,  
    0,  255,  21,  
    0,  255,  25,  
    0,  255,  29,  
    0,  255,  33,  
    0,  255,  42,  
    0,  255,  46,  
    0,  255,  51,  
    0,  255,  55,  
    0,  255,  63,  
    0,  255,  67,  
    0,  255,  72,  
    0,  255,  76,  
    0,  255,  80,  
    0,  255,  89,  
    0,  255,  93,  
    0,  255,  97,  
    0,  255,  101,  
    0,  255,  110,  
    0,  255,  114,  
    0,  255,  119,  
    0,  255,  123,  
    0,  255,  131,  
    0,  255,  135,  
    0,  255,  140,  
    0,  255,  144,  
    0,  255,  153,  
    0,  255,  157,  
    0,  255,  161,  
    0,  255,  165,  
    0,  255,  169,  
    0,  255,  178,  
    0,  255,  182,  
    0,  255,  187,  
    0,  255,  191,  
    0,  255,  199,  
    0,  255,  203,  
    0,  255,  208,  
    0,  255,  212,  
    0,  255,  221,  
    0,  255,  225,  
    0,  255,  229,  
    0,  255,  233,  
    0,  255,  242,  
    0,  255,  246,  
    0,  255,  250,  
    0,  255,  255,  
    0,  250,  255,  
    0,  242,  255,  
    0,  238,  255,  
    0,  233,  255,  
    0,  229,  255,  
    0,  221,  255,  
    0,  216,  255,  
    0,  212,  255,  
    0,  208,  255,  
    0,  199,  255,  
    0,  195,  255,  
    0,  191,  255,  
    0,  187,  255,  
    0,  178,  255,  
    0,  174,  255,  
    0,  170,  255,  
    0,  165,  255,  
    0,  161,  255,  
    0,  153,  255,  
    0,  148,  255,  
    0,  144,  255,  
    0,  140,  255,  
    0,  131,  255,  
    0,  127,  255,  
    0,  123,  255,  
    0,  119,  255,  
    0,  110,  255,  
    0,  106,  255,  
    0,  102,  255,  
    0,  97,  255,  
    0,  89,  255,  
    0,  85,  255,  
    0,  80,  255,  
    0,  76,  255,  
    0,  72,  255,  
    0,  63,  255,  
    0,  59,  255,  
    0,  55,  255,  
    0,  51,  255,  
    0,  42,  255,  
    0,  38,  255,  
    0,  34,  255,  
    0,  29,  255,  
    0,  21,  255,  
    0,  17,  255,  
    0,  12,  255,  
    0,  8,  255,  
    0,  0,  255
};

unsigned char RedVessels[768] =
{
    0,  0,  0,  
    0,  0,  1,  
    0,  0,  2,  
    0,  0,  3,  
    0,  0,  5,  
    0,  0,  6,  
    0,  0,  7,  
    0,  0,  9,  
    0,  0,  10,  
    0,  0,  11,  
    0,  0,  12,  
    0,  0,  14,  
    0,  0,  15,  
    0,  0,  16,  
    0,  0,  18,  
    0,  0,  19,  
    0,  0,  20,  
    0,  0,  21,  
    0,  0,  23,  
    0,  0,  24,  
    0,  0,  25,  
    0,  0,  27,  
    0,  0,  28,  
    0,  0,  29,  
    0,  0,  30,  
    0,  0,  32,  
    0,  0,  33,  
    0,  0,  34,  
    0,  0,  36,  
    0,  0,  37,  
    0,  0,  38,  
    0,  0,  39,  
    0,  0,  41,  
    0,  0,  42,  
    0,  0,  43,  
    0,  0,  45,  
    0,  0,  46,  
    0,  0,  47,  
    0,  0,  49,  
    0,  0,  50,  
    0,  0,  51,  
    0,  0,  52,  
    0,  0,  54,  
    0,  0,  55,  
    0,  0,  56,  
    0,  0,  58,  
    0,  0,  59,  
    0,  0,  60,  
    0,  0,  61,  
    0,  0,  63,  
    0,  0,  64,  
    0,  0,  65,  
    0,  0,  67,  
    0,  0,  68,  
    0,  0,  69,  
    0,  0,  70,  
    0,  0,  72,  
    0,  0,  73,  
    0,  0,  74,  
    0,  0,  76,  
    0,  0,  77,  
    0,  0,  78,  
    0,  0,  79,  
    0,  0,  81,  
    0,  0,  82,  
    0,  0,  83,  
    0,  0,  85,  
    0,  0,  86,  
    0,  0,  87,  
    0,  0,  88,  
    0,  0,  90,  
    0,  0,  91,  
    0,  0,  92,  
    0,  0,  94,  
    0,  0,  95,  
    0,  0,  96,  
    0,  0,  98,  
    0,  0,  99,  
    0,  0,  100,  
    0,  0,  101,  
    0,  0,  103,  
    0,  0,  104,  
    0,  0,  105,  
    0,  0,  107,  
    0,  0,  108,  
    0,  0,  109,  
    0,  0,  110,  
    0,  0,  112,  
    0,  0,  113,  
    0,  0,  114,  
    0,  0,  116,  
    0,  0,  117,  
    0,  0,  118,  
    0,  0,  119,  
    0,  0,  121,  
    0,  0,  122,  
    0,  0,  123,  
    0,  0,  125,  
    0,  0,  126,  
    0,  0,  127,  
    0,  0,  128,  
    0,  0,  130,  
    0,  0,  131,  
    0,  0,  132,  
    0,  0,  134,  
    0,  0,  135,  
    0,  0,  136,  
    0,  0,  137,  
    0,  0,  139,  
    0,  0,  140,  
    0,  0,  141,  
    0,  0,  143,  
    0,  0,  144,  
    0,  0,  145,  
    0,  0,  147,  
    0,  0,  148,  
    0,  0,  149,  
    0,  0,  150,  
    0,  0,  152,  
    0,  0,  153,  
    0,  0,  154,  
    0,  0,  156,  
    0,  0,  157,  
    0,  0,  158,  
    0,  0,  159,  
    0,  0,  161,  
    0,  0,  162,  
    0,  0,  163,  
    0,  0,  165,  
    0,  0,  166,  
    0,  0,  167,  
    0,  0,  168,  
    0,  0,  170,  
    0,  0,  171,  
    0,  0,  172,  
    0,  0,  174,  
    0,  0,  175,  
    0,  0,  176,  
    0,  0,  177,  
    0,  0,  179,  
    0,  0,  180,  
    0,  0,  181,  
    0,  0,  183,  
    0,  0,  184,  
    0,  0,  185,  
    0,  0,  186,  
    0,  0,  188,  
    0,  0,  189,  
    0,  0,  190,  
    0,  0,  192,  
    0,  0,  193,  
    0,  0,  194,  
    0,  0,  196,  
    0,  0,  197,  
    1,  1,  198,  
    2,  3,  199,  
    3,  5,  200,  
    4,  6,  201,  
    5,  8,  202,  
    6,  10,  203,  
    7,  11,  204,  
    8,  13,  206,  
    9,  15,  207,  
    10,  16,  208,  
    11,  18,  209,  
    12,  20,  210,  
    13,  21,  211,  
    14,  23,  212,  
    15,  25,  213,  
    16,  26,  214,  
    17,  28,  215,  
    18,  30,  216,  
    19,  32,  217,  
    20,  33,  219,  
    21,  35,  220,  
    22,  37,  221,  
    23,  38,  222,  
    24,  40,  223,  
    25,  42,  224,  
    26,  43,  225,  
    27,  45,  226,  
    28,  47,  227,  
    29,  48,  228,  
    30,  50,  229,  
    31,  52,  231,  
    32,  53,  232,  
    33,  55,  233,  
    34,  57,  234,  
    35,  59,  235,  
    36,  60,  236,  
    37,  62,  237,  
    38,  64,  238,  
    39,  65,  239,  
    40,  67,  240,  
    41,  69,  241,  
    42,  70,  243,  
    43,  72,  244,  
    44,  74,  245,  
    45,  75,  246,  
    46,  77,  247,  
    47,  79,  248,  
    48,  80,  249,  
    49,  82,  250,  
    50,  84,  251,  
    51,  86,  252,  
    52,  87,  253,  
    53,  89,  255,  
    55,  91,  255,  
    57,  93,  255,  
    59,  95,  255,  
    61,  97,  255,  
    64,  99,  255,  
    66,  101,  255,  
    68,  103,  255,  
    70,  105,  255,  
    72,  107,  255,  
    75,  109,  255,  
    77,  111,  255,  
    79,  113,  255,  
    81,  115,  255,  
    84,  117,  255,  
    86,  119,  255,  
    88,  121,  255,  
    90,  124,  255,  
    92,  126,  255,  
    95,  128,  255,  
    97,  130,  255,  
    99,  132,  255,  
    101,  134,  255,  
    103,  136,  255,  
    106,  138,  255,  
    108,  140,  255,  
    110,  142,  255,  
    112,  144,  255,  
    114,  146,  255,  
    117,  148,  255,  
    119,  150,  255,  
    121,  152,  255,  
    123,  154,  255,  
    126,  156,  255,  
    128,  158,  255,  
    136,  164,  255,  
    144,  170,  255,  
    152,  176,  255,  
    159,  182,  255,  
    167,  188,  255,  
    175,  194,  255,  
    183,  200,  255,  
    191,  206,  255,  
    199,  212,  255,  
    207,  218,  255,  
    215,  224,  255,  
    223,  230,  255,  
    231,  236,  255,  
    239,  242,  255,  
    247,  248,  255
};

unsigned char Spectrum[768] =
{
    255,  0,  255,  
    255,  0,  250,  
    255,  0,  245,  
    255,  0,  240,  
    255,  0,  235,  
    255,  0,  230,  
    255,  0,  225,  
    255,  0,  220,  
    255,  0,  215,  
    255,  0,  210,  
    255,  0,  205,  
    255,  0,  200,  
    255,  0,  195,  
    255,  0,  190,  
    255,  0,  185,  
    255,  0,  180,  
    255,  0,  175,  
    255,  0,  170,  
    255,  0,  165,  
    255,  0,  160,  
    255,  0,  155,  
    255,  0,  150,  
    255,  0,  145,  
    255,  0,  140,  
    255,  0,  135,  
    255,  0,  130,  
    255,  0,  125,  
    255,  0,  120,  
    255,  0,  115,  
    255,  0,  110,  
    255,  0,  105,  
    255,  0,  100,  
    255,  0,  95,  
    255,  0,  90,  
    255,  0,  85,  
    255,  0,  80,  
    255,  0,  75,  
    255,  0,  70,  
    255,  0,  65,  
    255,  0,  60,  
    255,  0,  55,  
    255,  0,  50,  
    255,  0,  45,  
    255,  0,  40,  
    255,  0,  35,  
    255,  0,  30,  
    255,  0,  25,  
    255,  0,  20,  
    255,  0,  15,  
    255,  0,  10,  
    255,  0,  5,  
    255,  0,  0,  
    255,  5,  0,  
    255,  10,  0,  
    255,  15,  0,  
    255,  20,  0,  
    255,  25,  0,  
    255,  30,  0,  
    255,  35,  0,  
    255,  40,  0,  
    255,  45,  0,  
    255,  50,  0,  
    255,  55,  0,  
    255,  60,  0,  
    255,  65,  0,  
    255,  70,  0,  
    255,  75,  0,  
    255,  80,  0,  
    255,  85,  0,  
    255,  90,  0,  
    255,  95,  0,  
    255,  100,  0,  
    255,  105,  0,  
    255,  110,  0,  
    255,  115,  0,  
    255,  120,  0,  
    255,  125,  0,  
    255,  130,  0,  
    255,  135,  0,  
    255,  140,  0,  
    255,  145,  0,  
    255,  150,  0,  
    255,  155,  0,  
    255,  160,  0,  
    255,  165,  0,  
    255,  170,  0,  
    255,  175,  0,  
    255,  180,  0,  
    255,  185,  0,  
    255,  190,  0,  
    255,  195,  0,  
    255,  200,  0,  
    255,  205,  0,  
    255,  210,  0,  
    255,  215,  0,  
    255,  220,  0,  
    255,  225,  0,  
    255,  230,  0,  
    255,  235,  0,  
    255,  240,  0,  
    255,  245,  0,  
    255,  251,  0,  
    255,  255,  0,  
    250,  255,  0,  
    245,  255,  0,  
    240,  255,  0,  
    235,  255,  0,  
    230,  255,  0,  
    225,  255,  0,  
    220,  255,  0,  
    215,  255,  0,  
    210,  255,  0,  
    205,  255,  0,  
    200,  255,  0,  
    195,  255,  0,  
    190,  255,  0,  
    185,  255,  0,  
    180,  255,  0,  
    175,  255,  0,  
    170,  255,  0,  
    165,  255,  0,  
    160,  255,  0,  
    155,  255,  0,  
    150,  255,  0,  
    145,  255,  0,  
    140,  255,  0,  
    135,  255,  0,  
    130,  255,  0,  
    125,  255,  0,  
    120,  255,  0,  
    115,  255,  0,  
    110,  255,  0,  
    105,  255,  0,  
    100,  255,  0,  
    95,  255,  0,  
    90,  255,  0,  
    85,  255,  0,  
    80,  255,  0,  
    75,  255,  0,  
    70,  255,  0,  
    65,  255,  0,  
    60,  255,  0,  
    55,  255,  0,  
    50,  255,  0,  
    45,  255,  0,  
    40,  255,  0,  
    35,  255,  0,  
    30,  255,  0,  
    25,  255,  0,  
    20,  255,  0,  
    15,  255,  0,  
    10,  255,  0,  
    5,  255,  0,  
    0,  255,  0,  
    0,  255,  5,  
    0,  255,  10,  
    0,  255,  15,  
    0,  255,  20,  
    0,  255,  25,  
    0,  255,  30,  
    0,  255,  35,  
    0,  255,  40,  
    0,  255,  45,  
    0,  255,  50,  
    0,  255,  55,  
    0,  255,  60,  
    0,  255,  65,  
    0,  255,  70,  
    0,  255,  75,  
    0,  255,  80,  
    0,  255,  85,  
    0,  255,  90,  
    0,  255,  95,  
    0,  255,  100,  
    0,  255,  105,  
    0,  255,  110,  
    0,  255,  115,  
    0,  255,  120,  
    0,  255,  125,  
    0,  255,  130,  
    0,  255,  135,  
    0,  255,  140,  
    0,  255,  145,  
    0,  255,  150,  
    0,  255,  155,  
    0,  255,  160,  
    0,  255,  165,  
    0,  255,  170,  
    0,  255,  175,  
    0,  255,  180,  
    0,  255,  185,  
    0,  255,  190,  
    0,  255,  195,  
    0,  255,  200,  
    0,  255,  205,  
    0,  255,  210,  
    0,  255,  215,  
    0,  255,  220,  
    0,  255,  225,  
    0,  255,  230,  
    0,  255,  235,  
    0,  255,  240,  
    0,  255,  245,  
    0,  255,  250,  
    0,  255,  255,  
    0,  250,  255,  
    0,  245,  255,  
    0,  240,  255,  
    0,  235,  255,  
    0,  230,  255,  
    0,  225,  255,  
    0,  220,  255,  
    0,  215,  255,  
    0,  210,  255,  
    0,  205,  255,  
    0,  200,  255,  
    0,  195,  255,  
    0,  190,  255,  
    0,  185,  255,  
    0,  180,  255,  
    0,  175,  255,  
    0,  170,  255,  
    0,  165,  255,  
    0,  160,  255,  
    0,  155,  255,  
    0,  150,  255,  
    0,  145,  255,  
    0,  140,  255,  
    0,  135,  255,  
    0,  130,  255,  
    0,  125,  255,  
    0,  120,  255,  
    0,  115,  255,  
    0,  110,  255,  
    0,  105,  255,  
    0,  100,  255,  
    0,  95,  255,  
    0,  90,  255,  
    0,  85,  255,  
    0,  80,  255,  
    0,  75,  255,  
    0,  70,  255,  
    0,  65,  255,  
    0,  60,  255,  
    0,  55,  255,  
    0,  50,  255,  
    0,  45,  255,  
    0,  40,  255,  
    0,  35,  255,  
    0,  30,  255,  
    0,  25,  255,  
    0,  20,  255,  
    0,  15,  255,  
    0,  10,  255,  
    0,  5,  255,  
    0,  0,  255
};

unsigned char Stern[768] = 
{
    0,  0,  0,  
    1,  1,  18,  
    3,  2,  36,  
    5,  3,  54,  
    7,  4,  72,  
    9,  5,  90,  
    11,  6,  108,  
    13,  7,  127,  
    15,  8,  145,  
    17,  9,  163,  
    19,  10,  181,  
    21,  11,  199,  
    23,  12,  217,  
    25,  13,  235,  
    27,  14,  254,  
    29,  15,  249,  
    31,  16,  244,  
    33,  17,  239,  
    35,  18,  234,  
    37,  19,  229,  
    39,  20,  223,  
    41,  21,  218,  
    43,  22,  213,  
    45,  23,  208,  
    47,  24,  203,  
    49,  25,  197,  
    51,  26,  192,  
    53,  27,  187,  
    55,  28,  182,  
    57,  29,  177,  
    59,  30,  172,  
    61,  31,  166,  
    63,  32,  161,  
    65,  33,  156,  
    67,  34,  151,  
    69,  35,  146,  
    71,  36,  140,  
    73,  37,  135,  
    75,  38,  130,  
    77,  39,  125,  
    79,  40,  120,  
    81,  41,  115,  
    83,  42,  109,  
    85,  43,  104,  
    87,  44,  99,  
    89,  45,  94,  
    91,  46,  89,  
    93,  47,  83,  
    95,  48,  78,  
    97,  49,  73,  
    99,  50,  68,  
    101,  51,  63,  
    103,  52,  58,  
    105,  53,  52,  
    107,  54,  47,  
    109,  55,  42,  
    111,  56,  37,  
    113,  57,  32,  
    115,  58,  26,  
    117,  59,  21,  
    119,  60,  16,  
    121,  61,  11,  
    123,  62,  6,  
    125,  63,  0,  
    127,  64,  64,  
    129,  65,  65,  
    131,  66,  66,  
    133,  67,  67,  
    135,  68,  68,  
    137,  69,  69,  
    139,  70,  70,  
    141,  71,  71,  
    143,  72,  72,  
    145,  73,  73,  
    147,  74,  74,  
    149,  75,  75,  
    151,  76,  76,  
    153,  77,  77,  
    155,  78,  78,  
    157,  79,  79,  
    159,  80,  80,  
    161,  81,  81,  
    163,  82,  82,  
    165,  83,  83,  
    167,  84,  84,  
    169,  85,  85,  
    171,  86,  86,  
    173,  87,  87,  
    175,  88,  88,  
    177,  89,  89,  
    179,  90,  90,  
    181,  91,  91,  
    183,  92,  92,  
    185,  93,  93,  
    187,  94,  94,  
    189,  95,  95,  
    191,  96,  96,  
    193,  97,  97,  
    195,  98,  98,  
    197,  99,  99,  
    199,  100,  100,  
    201,  101,  101,  
    203,  102,  102,  
    205,  103,  103,  
    207,  104,  104,  
    209,  105,  105,  
    211,  106,  106,  
    213,  107,  107,  
    215,  108,  108,  
    217,  109,  109,  
    219,  110,  110,  
    221,  111,  111,  
    223,  112,  112,  
    225,  113,  113,  
    227,  114,  114,  
    229,  115,  115,  
    231,  116,  116,  
    233,  117,  117,  
    235,  118,  118,  
    237,  119,  119,  
    239,  120,  120,  
    241,  121,  121,  
    243,  122,  122,  
    245,  123,  123,  
    247,  124,  124,  
    249,  125,  125,  
    251,  126,  126,  
    253,  127,  127,  
    255,  128,  128,  
    251,  129,  129,  
    247,  130,  130,  
    243,  131,  131,  
    238,  132,  132,  
    234,  133,  133,  
    230,  134,  134,  
    226,  135,  135,  
    221,  136,  136,  
    217,  137,  137,  
    213,  138,  138,  
    209,  139,  139,  
    204,  140,  140,  
    200,  141,  141,  
    196,  142,  142,  
    192,  143,  143,  
    187,  144,  144,  
    183,  145,  145,  
    179,  146,  146,  
    175,  147,  147,  
    170,  148,  148,  
    166,  149,  149,  
    162,  150,  150,  
    158,  151,  151,  
    153,  152,  152,  
    149,  153,  153,  
    145,  154,  154,  
    141,  155,  155,  
    136,  156,  156,  
    132,  157,  157,  
    128,  158,  158,  
    124,  159,  159,  
    119,  160,  160,  
    115,  161,  161,  
    111,  162,  162,  
    107,  163,  163,  
    102,  164,  164,  
    98,  165,  165,  
    94,  166,  166,  
    90,  167,  167,  
    85,  168,  168,  
    81,  169,  169,  
    77,  170,  170,  
    73,  171,  171,  
    68,  172,  172,  
    64,  173,  173,  
    60,  174,  174,  
    56,  175,  175,  
    51,  176,  176,  
    47,  177,  177,  
    43,  178,  178,  
    39,  179,  179,  
    34,  180,  180,  
    30,  181,  181,  
    26,  182,  182,  
    22,  183,  183,  
    17,  184,  184,  
    13,  185,  185,  
    9,  186,  186,  
    5,  187,  187,  
    0,  188,  188,  
    3,  189,  189,  
    7,  190,  190,  
    11,  191,  191,  
    15,  192,  192,  
    19,  193,  193,  
    22,  194,  194,  
    26,  195,  195,  
    30,  196,  196,  
    34,  197,  197,  
    38,  198,  198,  
    41,  199,  199,  
    45,  200,  200,  
    49,  201,  201,  
    53,  202,  202,  
    57,  203,  203,  
    60,  204,  204,  
    64,  205,  205,  
    68,  206,  206,  
    72,  207,  207,  
    76,  208,  208,  
    79,  209,  209,  
    83,  210,  210,  
    87,  211,  211,  
    91,  212,  212,  
    95,  213,  213,  
    98,  214,  214,  
    102,  215,  215,  
    106,  216,  216,  
    110,  217,  217,  
    114,  218,  218,  
    117,  219,  219,  
    121,  220,  220,  
    125,  221,  221,  
    129,  222,  222,  
    133,  223,  223,  
    137,  224,  224,  
    140,  225,  225,  
    144,  226,  226,  
    148,  227,  227,  
    152,  228,  228,  
    156,  229,  229,  
    159,  230,  230,  
    163,  231,  231,  
    167,  232,  232,  
    171,  233,  233,  
    175,  234,  234,  
    178,  235,  235,  
    182,  236,  236,  
    186,  237,  237,  
    190,  238,  238,  
    194,  239,  239,  
    197,  240,  240,  
    201,  241,  241,  
    205,  242,  242,  
    209,  243,  243,  
    213,  244,  244,  
    216,  245,  245,  
    220,  246,  246,  
    224,  247,  247,  
    228,  248,  248,  
    232,  249,  249,  
    235,  250,  250,  
    239,  251,  251,  
    243,  252,  252,  
    247,  253,  253,  
    251,  254,  254,  
    255,  255,  255
};

unsigned char UCLA[768] = 
{
    0,  0,  0,  
    0,  0,  0,  
    0,  0,  0,  
    0,  0,  0,  
    0,  0,  0,  
    0,  0,  0,  
    0,  0,  0,  
    0,  0,  0,  
    0,  0,  0,  
    0,  0,  0,  
    0,  0,  0,  
    0,  0,  0,  
    102,  0,  85,  
    102,  0,  85,  
    102,  0,  85,  
    102,  0,  85,  
    136,  0,  119,  
    136,  0,  119,  
    136,  0,  119,  
    136,  0,  119,  
    136,  0,  119,  
    136,  0,  119,  
    136,  0,  119,  
    136,  0,  119,  
    136,  0,  136,  
    136,  0,  136,  
    136,  0,  136,  
    136,  0,  136,  
    153,  0,  136,  
    153,  0,  136,  
    153,  0,  136,  
    153,  0,  136,  
    153,  0,  136,  
    153,  0,  136,  
    153,  0,  136,  
    153,  0,  136,  
    153,  0,  102,  
    153,  0,  102,  
    153,  0,  102,  
    153,  0,  102,  
    153,  0,  68,  
    153,  0,  68,  
    153,  0,  68,  
    153,  0,  68,  
    153,  0,  68,  
    153,  0,  68,  
    153,  0,  68,  
    153,  0,  68,  
    170,  0,  0,  
    170,  0,  0,  
    170,  0,  0,  
    170,  0,  0,  
    187,  0,  0,  
    187,  0,  0,  
    187,  0,  0,  
    187,  0,  0,  
    204,  0,  0,  
    204,  0,  0,  
    204,  0,  0,  
    204,  0,  0,  
    204,  0,  0,  
    204,  0,  0,  
    204,  0,  0,  
    204,  0,  0,  
    221,  0,  0,  
    221,  0,  0,  
    221,  0,  0,  
    221,  0,  0,  
    221,  51,  0,  
    221,  51,  0,  
    221,  51,  0,  
    221,  51,  0,  
    221,  51,  0,  
    221,  51,  0,  
    221,  51,  0,  
    221,  51,  0,  
    221,  85,  0,  
    221,  85,  0,  
    221,  85,  0,  
    221,  85,  0,  
    221,  119,  0,  
    221,  119,  0,  
    221,  119,  0,  
    221,  119,  0,  
    221,  119,  0,  
    221,  119,  0,  
    221,  119,  0,  
    221,  119,  0,  
    221,  136,  0,  
    221,  136,  0,  
    221,  136,  0,  
    221,  136,  0,  
    221,  153,  0,  
    221,  153,  0,  
    221,  153,  0,  
    221,  153,  0,  
    187,  153,  0,  
    187,  153,  0,  
    187,  153,  0,  
    187,  153,  0,  
    187,  153,  0,  
    187,  153,  0,  
    187,  153,  0,  
    187,  153,  0,  
    170,  170,  0,  
    170,  170,  0,  
    170,  170,  0,  
    170,  170,  0,  
    153,  170,  0,  
    153,  170,  0,  
    153,  170,  0,  
    153,  170,  0,  
    153,  170,  0,  
    153,  170,  0,  
    153,  170,  0,  
    153,  170,  0,  
    136,  170,  0,  
    136,  170,  0,  
    136,  170,  0,  
    136,  170,  0,  
    119,  170,  0,  
    119,  170,  0,  
    119,  170,  0,  
    119,  170,  0,  
    119,  170,  0,  
    119,  170,  0,  
    119,  170,  0,  
    119,  170,  0,  
    85,  170,  0,  
    85,  170,  0,  
    85,  170,  0,  
    85,  170,  0,  
    71,  170,  0,  
    71,  170,  0,  
    71,  170,  0,  
    71,  170,  0,  
    0,  185,  0,  
    0,  185,  0,  
    0,  185,  0,  
    0,  185,  0,  
    0,  185,  0,  
    0,  185,  0,  
    0,  185,  0,  
    0,  185,  0,  
    0,  204,  0,  
    0,  204,  0,  
    0,  204,  0,  
    0,  204,  0,  
    0,  221,  0,  
    0,  221,  0,  
    0,  221,  0,  
    0,  221,  0,  
    0,  221,  0,  
    0,  221,  0,  
    0,  221,  0,  
    0,  221,  0,  
    0,  238,  0,  
    0,  238,  0,  
    0,  238,  0,  
    0,  238,  0,  
    0,  255,  0,  
    0,  255,  0,  
    0,  255,  0,  
    0,  255,  0,  
    0,  255,  0,  
    0,  255,  0,  
    0,  255,  0,  
    0,  255,  0,  
    0,  255,  102,  
    0,  255,  102,  
    0,  255,  102,  
    0,  255,  102,  
    0,  255,  187,  
    0,  255,  187,  
    0,  255,  187,  
    0,  255,  187,  
    0,  238,  204,  
    0,  238,  204,  
    0,  238,  204,  
    0,  238,  204,  
    0,  238,  204,  
    0,  238,  204,  
    0,  238,  204,  
    0,  238,  204,  
    0,  221,  238,  
    0,  221,  238,  
    0,  221,  238,  
    0,  221,  238,  
    0,  204,  238,  
    0,  204,  238,  
    0,  204,  238,  
    0,  204,  238,  
    0,  204,  238,  
    0,  204,  238,  
    0,  204,  238,  
    0,  204,  238,  
    0,  187,  255,  
    0,  187,  255,  
    0,  187,  255,  
    0,  187,  255,  
    0,  170,  255,  
    0,  170,  255,  
    0,  170,  255,  
    0,  170,  255,  
    0,  170,  255,  
    0,  170,  255,  
    0,  170,  255,  
    0,  170,  255,  
    0,  153,  255,  
    0,  153,  255,  
    0,  153,  255,  
    0,  153,  255,  
    0,  119,  255,  
    0,  119,  255,  
    0,  119,  255,  
    0,  119,  255,  
    0,  85,  255,  
    0,  85,  255,  
    0,  85,  255,  
    0,  85,  255,  
    0,  85,  255,  
    0,  85,  255,  
    0,  85,  255,  
    0,  85,  255,  
    0,  51,  255,  
    0,  51,  255,  
    0,  51,  255,  
    0,  51,  255,  
    0,  0,  255,  
    0,  0,  255,  
    0,  0,  255,  
    0,  0,  255,  
    0,  0,  255,  
    0,  0,  255,  
    0,  0,  255,  
    0,  0,  255,  
    0,  0,  238,  
    0,  0,  238,  
    0,  0,  238,  
    0,  0,  238,  
    0,  0,  221,  
    0,  0,  221,  
    0,  0,  221,  
    0,  0,  221,  
    0,  0,  221,  
    0,  0,  221,  
    0,  0,  221,  
    0,  0,  221,  
    0,  0,  204,  
    0,  0,  204,  
    0,  0,  204,  
    0,  0,  204,  
    0,  0,  255,  
    0,  0,  255,  
    0,  0,  255,  
    0,  0,  255
};

const FIRST_POSTFIX_COMPONENT aMPRSectionType[3] = {
    CORONAL, SAGITTAL, AXIAL
};

PseudoColorOperation::PseudoColorOperation(
const std::string& strPseudoColorName) : m_strPseudoColorName(strPseudoColorName){

}

PseudoColorOperation::~PseudoColorOperation(){

}

bool PseudoColorOperation::ModifyGraphicObject() const{
    std::string key("");
    std::shared_ptr<Mcsf::MedViewer3D::IGraphicObject> go = nullptr;

    unsigned char pPseudoColorData[768];
    if (m_strPseudoColorName == "Gray")
    {
        for (int i = 0; i < 256; ++i)
        {
            pPseudoColorData[i * 3 + 0] = static_cast<unsigned char>(i);
            pPseudoColorData[i * 3 + 1] = static_cast<unsigned char>(i);
            pPseudoColorData[i * 3 + 2] = static_cast<unsigned char>(i);
        }
    }
    else if (m_strPseudoColorName == "Red")
    {
        for (int i = 0; i < 256; ++i)
        {
            pPseudoColorData[i * 3 + 0] = static_cast<unsigned char>(i);
            pPseudoColorData[i * 3 + 1] = 0;
            pPseudoColorData[i * 3 + 2] = 0;
        }
    }   
    else if (m_strPseudoColorName == "Green")
    {
        for (int i = 0; i < 256; ++i)
        {
            pPseudoColorData[i * 3 + 0] = 0;
            pPseudoColorData[i * 3 + 1] = static_cast<unsigned char>(i);
            pPseudoColorData[i * 3 + 2] = 0;
        }
    }
    else if (m_strPseudoColorName == "HotIron")
    {
        for (int i = 0; i <= 127; ++i)
        {
            pPseudoColorData[i * 3 + 0] = static_cast<unsigned char>(i) * 2;
            pPseudoColorData[i * 3 + 1] = 0;
            pPseudoColorData[i * 3 + 2] = 0;
        }
        for (int i = 128; i <= 191; ++i)
        {
            pPseudoColorData[i * 3 + 0] = 255;
            pPseudoColorData[i * 3 + 1] = static_cast<unsigned char>(i - 128) * 2;
            pPseudoColorData[i * 3 + 2] = 0;
        }
        for (int i = 192; i <= 254; ++i)
        {
            pPseudoColorData[i * 3 + 0] = 255;
            pPseudoColorData[i * 3 + 1] = static_cast<unsigned char>(i - 128) * 2;
            pPseudoColorData[i * 3 + 2] = static_cast<unsigned char>(i - 191) * 4;
        }
        pPseudoColorData[255 * 3 + 0] = 255;
        pPseudoColorData[255 * 3 + 1] = 255;
        pPseudoColorData[255 * 3 + 2] = 255;
    }
    else if(m_strPseudoColorName == "Bones")
    {
        for (int i = 0; i < 256; ++i)
        {
            pPseudoColorData[i * 3 + 0] = Bones[i * 3 + 2];
            pPseudoColorData[i * 3 + 1] = Bones[i * 3 + 1];
            pPseudoColorData[i * 3 + 2] = Bones[i * 3 + 0];
        }
    }
    else if(m_strPseudoColorName == "Cardiac")
    {
        for (int i = 0; i < 256; ++i)
        {
            pPseudoColorData[i * 3 + 0] = Cardiac[i * 3 + 2];
            pPseudoColorData[i * 3 + 1] = Cardiac[i * 3 + 1];
            pPseudoColorData[i * 3 + 2] = Cardiac[i * 3 + 0];
        }
    }
    else if(m_strPseudoColorName == "Rainbow1")
    {
        for (int i = 0; i < 256; ++i)
        {
            pPseudoColorData[i * 3 + 0] = Rainbow1[i * 3 + 2];
            pPseudoColorData[i * 3 + 1] = Rainbow1[i * 3 + 1];
            pPseudoColorData[i * 3 + 2] = Rainbow1[i * 3 + 0];
        }
    }
    else if(m_strPseudoColorName == "Rainbow2")
    {
        for (int i = 0; i < 256; ++i)
        {
            pPseudoColorData[i * 3 + 0] = Rainbow2[i * 3 + 2];
            pPseudoColorData[i * 3 + 1] = Rainbow2[i * 3 + 1];
            pPseudoColorData[i * 3 + 2] = Rainbow2[i * 3 + 0];
        }
    }
    else if(m_strPseudoColorName == "RedVessels")
    {
        for (int i = 0; i < 256; ++i)
        {
            pPseudoColorData[i * 3 + 0] = RedVessels[i * 3 + 2];
            pPseudoColorData[i * 3 + 1] = RedVessels[i * 3 + 1];
            pPseudoColorData[i * 3 + 2] = RedVessels[i * 3 + 0];
        }
    }
    else if(m_strPseudoColorName == "Spectrum")
    {
        for (int i = 0; i < 256; ++i)
        {
            pPseudoColorData[i * 3 + 0] = Spectrum[i * 3 + 2];
            pPseudoColorData[i * 3 + 1] = Spectrum[i * 3 + 1];
            pPseudoColorData[i * 3 + 2] = Spectrum[i * 3 + 0];
        }
    }
    else if(m_strPseudoColorName == "Stern")
    {
        for (int i = 0; i < 256; ++i)
        {
            pPseudoColorData[i * 3 + 0] = Stern[i * 3 + 2];
            pPseudoColorData[i * 3 + 1] = Stern[i * 3 + 1];
            pPseudoColorData[i * 3 + 2] = Stern[i * 3 + 0];
        }
    }
    else if(m_strPseudoColorName == "UCLA")
    {
        for (int i = 0; i < 256; ++i)
        {
            pPseudoColorData[i * 3 + 0] = UCLA[i * 3 + 2];
            pPseudoColorData[i * 3 + 1] = UCLA[i * 3 + 1];
            pPseudoColorData[i * 3 + 2] = UCLA[i * 3 + 0];
        }
    }
    
    std::shared_ptr<MPRGraphicObject> spMPRGO = nullptr;
    for (int i = 0; i < mVecGoKeys.size(); i++)
    {
        go = mModelWarehouse->GetModelObject(mVecGoKeys[i]);
        spMPRGO = std::dynamic_pointer_cast<MPRGraphicObject>(go);
        if (spMPRGO == nullptr){
            TPS_LOG_DEV_ERROR<<"PseudoColorOperation Failed to get MPR : "<<mVecGoKeys[i];
            continue;
        }
        spMPRGO->SetPseudoColorTable(m_strPseudoColorName, pPseudoColorData, 256);
        spMPRGO->SetDirty(true);
    }

    return true;
}

TPS_END_NAMESPACE  // end namespace tps
